var app;(function(app){"use strict";angular.module("flickrAlbumDemo",["flickrAlbumDemo.core"])})(app||(app={}));var amo;(function(amo){var flickr;(function(flickr){"use strict";angular.module("amo.flickr",["amo.flickr.album","amo.flickr.albumList","amo.flickr.core"])})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var app;(function(app){var core;(function(core){"use strict";angular.module("flickrAlbumDemo.core",["amo.flickr"])})(core=app.core||(app.core={}))})(app||(app={}));var app;(function(app){var core;(function(core){"use strict";var AppConfig=function(){AppConfig.$inject=["amoFlickrConfigurationProvider"];function AppConfig(amoFlickrConfigurationProvider){amoFlickrConfigurationProvider.setApiKey("7aca3f4de277f6252ffc05aab58ab601")}return AppConfig}();core.AppConfig=AppConfig;angular.module("flickrAlbumDemo.core").config(AppConfig)})(core=app.core||(app.core={}))})(app||(app={}));var amo;(function(amo){var flickr;(function(flickr){var albumList;(function(albumList){"use strict";angular.module("amo.flickr.albumList",["amo.flickr.album","amo.flickr.core"])})(albumList=flickr.albumList||(flickr.albumList={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var albumList;(function(albumList){"use strict";angular.module("amo.flickr.albumList").component("amoFlickrAlbumList",{bindings:{userId:"@"},controller:"AmoFlickrAlbumListController",controllerAs:"flickrAlbumList",templateUrl:"flickr/album-list/flickr-album-list.html"})})(albumList=flickr.albumList||(flickr.albumList={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var albumList;(function(albumList){"use strict";var FlickrAlbumListController=function(){FlickrAlbumListController.$inject=["amoFlickrApiService"];function FlickrAlbumListController(amoFlickrApiService){this.amoFlickrApiService=amoFlickrApiService}FlickrAlbumListController.prototype.$onInit=function(){var _this=this;this.amoFlickrApiService.fetchAlbumList(this.userId).then(function(albums){_this.albums=albums;if(albums.length>0){_this.currentAlbumId=albums[0].id}})};FlickrAlbumListController.prototype.isAlbumActive=function(album){return this.currentAlbumId===album.id};FlickrAlbumListController.prototype.setAlbum=function(album){this.currentAlbumId=album.id};return FlickrAlbumListController}();albumList.FlickrAlbumListController=FlickrAlbumListController;angular.module("amo.flickr.albumList").controller("AmoFlickrAlbumListController",FlickrAlbumListController)})(albumList=flickr.albumList||(flickr.albumList={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var RunBlock=function(){RunBlock.$inject=["amoFlickrEventService"];function RunBlock(amoFlickrEventService){}return RunBlock}();angular.module("amo.flickr.album",["amo.flickr.core"]).run(RunBlock)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";angular.module("amo.flickr.album").component("amoFlickrAlbum",{bindings:{albumId:"@",userId:"@"},controller:"AmoFlickrAlbumController",controllerAs:"flickrAlbum",templateUrl:"flickr/album/flickr-album.html"})})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album_1){"use strict";var FlickrAlbumController=function(){FlickrAlbumController.$inject=["$element","$scope","amoFlickrApiService","amoFlickrConfiguration"];function FlickrAlbumController($element,$scope,amoFlickrApiService,amoFlickrConfiguration){this.$element=$element;this.$scope=$scope;this.amoFlickrApiService=amoFlickrApiService;this.amoFlickrConfiguration=amoFlickrConfiguration;this.currentPhotoIndex=-1}FlickrAlbumController.prototype.$onInit=function(){var _this=this;this.element=this.$element.children(".amo-flickr-album").get(0);this.setPhotoSize();this.thumbnailSize=this.amoFlickrConfiguration.thumbnailSize;this.$scope.$on("amo.flickr.windowResize",function(){_this.$scope.$apply(function(){return _this.setPhotoSize()})});this.$scope.$on("amo.flickr.navigateNext",function(){_this.$scope.$apply(function(){return _this.navigateNextPhoto()})});this.$scope.$on("amo.flickr.navigatePrevious",function(){_this.$scope.$apply(function(){return _this.navigatePreviousPhoto()})});this.$scope.$watch("flickrAlbum.albumId",function(albumId){if(!albumId){return}_this.amoFlickrApiService.fetchAlbum(albumId,_this.userId).then(function(album){_this.currentPhotoIndex=album.photo.length>0?0:-1;_this.album=album})})};FlickrAlbumController.prototype.getCurrentPhoto=function(){if(angular.isUndefined(this.album)){return null}return this.album.photo[this.currentPhotoIndex]};FlickrAlbumController.prototype.isPhotoActive=function(photo){if(this.currentPhotoIndex<0){return false}return this.getCurrentPhoto().id===photo.id};FlickrAlbumController.prototype.navigateNextPhoto=function(){if(angular.isDefined(this.album)&&this.currentPhotoIndex>=this.album.photo.length-1){return}this.currentPhotoIndex++};FlickrAlbumController.prototype.navigatePreviousPhoto=function(){if(this.currentPhotoIndex<=0){return}this.currentPhotoIndex--};FlickrAlbumController.prototype.setPhotoIndex=function(index){this.currentPhotoIndex=index};FlickrAlbumController.prototype.setPhotoSize=function(){this.photoHeight=this.element.offsetHeight-this.amoFlickrConfiguration.thumbnailSize-2;this.photoWidth=this.element.offsetWidth};return FlickrAlbumController}();album_1.FlickrAlbumController=FlickrAlbumController;angular.module("amo.flickr.album").controller("AmoFlickrAlbumController",FlickrAlbumController)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var FlickrEventService=function(){FlickrEventService.$inject=["$document","$rootScope","$window"];function FlickrEventService($document,$rootScope,$window){$window.addEventListener("resize",function(){$rootScope.$broadcast("amo.flickr.windowResize")});$document[0].body.addEventListener("keydown",function(e){switch(e.keyCode){case 37:case 38:$rootScope.$broadcast("amo.flickr.navigatePrevious");break;case 39:case 40:$rootScope.$broadcast("amo.flickr.navigateNext");break;default:break}})}return FlickrEventService}();album.FlickrEventService=FlickrEventService;angular.module("amo.flickr.album").service("amoFlickrEventService",FlickrEventService)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";angular.module("amo.flickr.core",[])})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";var _configuration={apiKey:null,thumbnailSize:100};var FlickrConfigurationProvider=function(){function FlickrConfigurationProvider(){}FlickrConfigurationProvider.prototype.$get=function(){return _configuration};FlickrConfigurationProvider.prototype.setApiKey=function(key){_configuration.apiKey=key;return this};FlickrConfigurationProvider.prototype.setThumbnailSize=function(thumbnailSize){_configuration.thumbnailSize=thumbnailSize;return this};FlickrConfigurationProvider.prototype.setUserId=function(userId){_configuration.userId=userId;return this};return FlickrConfigurationProvider}();core.FlickrConfigurationProvider=FlickrConfigurationProvider;angular.module("amo.flickr.core").provider("amoFlickrConfiguration",FlickrConfigurationProvider)})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var FlickrAlbumThumbnailListController=function(){FlickrAlbumThumbnailListController.$inject=["$element","$scope"];function FlickrAlbumThumbnailListController($element,$scope){this.$element=$element;this.$scope=$scope}FlickrAlbumThumbnailListController.prototype.$onInit=function(){var _this=this;var element=this.$element[0],parentBounds,parentWidth,width;this.$scope.$on("amo.flickr.thumbnailActive",function(event,bounds){parentBounds=element.getBoundingClientRect();parentWidth=parentBounds.right-parentBounds.left;width=bounds.offsetRight-bounds.offsetLeft;if(bounds.offsetRight>parentBounds.right||bounds.offsetLeft<parentBounds.left){_this.$element.animate({scrollLeft:_this.$element.scrollLeft()+bounds.positionLeft-(parentWidth-width)/2},400)}})};return FlickrAlbumThumbnailListController}();album.FlickrAlbumThumbnailListController=FlickrAlbumThumbnailListController;angular.module("amo.flickr.album").controller("AmoFlickrAlbumThumbnailListController",FlickrAlbumThumbnailListController)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var FlickrAlbumThumbnailListDirective=function(){function FlickrAlbumThumbnailListDirective(){this.bindToController=true;this.controller="AmoFlickrAlbumThumbnailListController";this.restrict="A"}FlickrAlbumThumbnailListDirective.instance=function(){return new FlickrAlbumThumbnailListDirective};return FlickrAlbumThumbnailListDirective}();album.FlickrAlbumThumbnailListDirective=FlickrAlbumThumbnailListDirective;angular.module("amo.flickr.album").directive("amoFlickrAlbumThumbnailList",FlickrAlbumThumbnailListDirective.instance)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var FlickrAlbumThumbnailController=function(){FlickrAlbumThumbnailController.$inject=["$element","$scope"];function FlickrAlbumThumbnailController($element,$scope){this.$element=$element;this.$scope=$scope}FlickrAlbumThumbnailController.prototype.$onChanges=function(changes){var bounds,position;if(angular.isUndefined(changes.isPhotoActive)||!changes.isPhotoActive.currentValue){return}bounds=this.$element[0].getBoundingClientRect();position=this.$element.position();this.$scope.$emit("amo.flickr.thumbnailActive",{offsetLeft:bounds.left,offsetRight:bounds.right,positionLeft:position.left})};FlickrAlbumThumbnailController.prototype.setPhotoIndex=function(){this.onClick({index:this.index})};return FlickrAlbumThumbnailController}();album.FlickrAlbumThumbnailController=FlickrAlbumThumbnailController;angular.module("amo.flickr.album").controller("AmoFlickrAlbumThumbnailController",FlickrAlbumThumbnailController)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var album;(function(album){"use strict";var FlickrAlbumThumbnailDirective=function(){function FlickrAlbumThumbnailDirective(){this.bindToController=true;this.controller="AmoFlickrAlbumThumbnailController";this.controllerAs="albumThumbnail";this.restrict="A";this.replace=true;this.scope={isPhotoActive:"<",index:"@",onClick:"&",photo:"<amoFlickrAlbumThumbnail",thumbnailSize:"@"};this.templateUrl="flickr/album/thumbnail/flickr-album-thumbnail.html"}FlickrAlbumThumbnailDirective.instance=function(){return new FlickrAlbumThumbnailDirective};return FlickrAlbumThumbnailDirective}();album.FlickrAlbumThumbnailDirective=FlickrAlbumThumbnailDirective;angular.module("amo.flickr.album").directive("amoFlickrAlbumThumbnail",FlickrAlbumThumbnailDirective.instance)})(album=flickr.album||(flickr.album={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";angular.module("amo.flickr.core").component("amoFlickrPhoto",{bindings:{height:"<?",photo:"<",size:"@",thumbnailSize:"@?",width:"<?"},controller:"AmoFlickrPhotoController",controllerAs:"flickrPhoto",templateUrl:"flickr/core/photo/flickr-photo.html"})})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";var FlickrPhotoController=function(){FlickrPhotoController.$inject=["$scope"];function FlickrPhotoController($scope){this.$scope=$scope}FlickrPhotoController.prototype.$onInit=function(){var _this=this;this.$scope.$watchGroup(["flickrPhoto.photo","flickrPhoto.width","flickrPhoto.height"],function(values){if(angular.isUndefined(values[0])||values[0]===null){return}_this.imageHeight=_this.getPhotoValue("height");_this.imageSource=_this.getPhotoValue("url");_this.imageWidth=_this.getPhotoValue("width");if(angular.isDefined(_this.thumbnailSize)){_this.thumbnailSource=_this.getPhotoValue("url",_this.thumbnailSize)}})};FlickrPhotoController.prototype.getPhotoValue=function(property,size){if(angular.isUndefined(this.photo)){return null}if(angular.isUndefined(size)){size=this.size}return this.photo[property+"_"+size]};return FlickrPhotoController}();core.FlickrPhotoController=FlickrPhotoController;angular.module("amo.flickr.core").controller("AmoFlickrPhotoController",FlickrPhotoController)})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";var FlickrApiConfigurationFactory=function(){function FlickrApiConfigurationFactory(){this.origin="https://api.flickr.com/services/rest/";return this}return FlickrApiConfigurationFactory}();core.FlickrApiConfigurationFactory=FlickrApiConfigurationFactory;angular.module("amo.flickr.core").factory("amoFlickrApiConfigurationFactory",FlickrApiConfigurationFactory)})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";var FlickrApiService=function(){FlickrApiService.$inject=["$http","$q","amoFlickrApiConfigurationFactory","amoFlickrConfiguration"];function FlickrApiService($http,$q,amoFlickrApiConfigurationFactory,amoFlickrConfiguration){this.$http=$http;this.$q=$q;this.amoFlickrApiConfigurationFactory=amoFlickrApiConfigurationFactory;this.amoFlickrConfiguration=amoFlickrConfiguration}FlickrApiService.prototype.get=function(method,config){var _this=this;if(angular.isUndefined(config)){config={}}if(angular.isUndefined(config.params)){config.params={}}angular.extend(config.params,{api_key:this.amoFlickrConfiguration.apiKey,format:"json",method:"flickr."+method,nojsoncallback:1});return this.$http.get(this.amoFlickrApiConfigurationFactory.origin,config).then(function(result){if(result.data.stat==="fail"){return _this.$q.reject(result.data)}return result.data})};FlickrApiService.prototype.fetchAlbum=function(albumId,userId){if(angular.isUndefined(userId)){userId=this.amoFlickrConfiguration.userId}return this.get("photosets.getPhotos",{params:{extras:"url_s,url_o",photoset_id:albumId,user_id:userId}}).then(function(data){return data.photoset})};FlickrApiService.prototype.fetchAlbumList=function(userId){if(angular.isUndefined(userId)){userId=this.amoFlickrConfiguration.userId}return this.get("photosets.getList",{params:{per_page:100,user_id:userId}}).then(function(data){return data.photosets.photoset})};return FlickrApiService}();core.FlickrApiService=FlickrApiService;angular.module("amo.flickr.core").service("amoFlickrApiService",FlickrApiService)})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";angular.module("amo.flickr.core").component("amoImage",{bindings:{height:"<?",imageAlt:"<?",imageHeight:"<",imageSource:"<",imageWidth:"<",thumbnailSource:"<",width:"<?"},controller:"AmoImageController",controllerAs:"image",templateUrl:"flickr/core/photo/image/image.html"})})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));var amo;(function(amo){var flickr;(function(flickr){var core;(function(core){"use strict";var ImageController=function(){ImageController.$inject=["$scope","$window"];function ImageController($scope,$window){this.$scope=$scope;this.$window=$window;this.imageStyle={}}ImageController.prototype.$onInit=function(){var _this=this;var asynchronousImage,width;this.$scope.$watch("image.imageSource",function(imageSource){if(angular.isUndefined(imageSource)){return}_this.isLoaded=false;asynchronousImage=new _this.$window.Image;asynchronousImage.onload=function(){_this.$scope.$apply(function(){_this.source=asynchronousImage.src;_this.isLoaded=true});if(angular.isDefined(_this.thumbnailSource)){asynchronousImage=new _this.$window.Image;asynchronousImage.onload=function(){_this.$scope.$apply(function(){_this.source=asynchronousImage.src})};asynchronousImage.src=_this.imageSource}};asynchronousImage.src=angular.isDefined(_this.thumbnailSource)?_this.thumbnailSource:_this.imageSource;_this.computeSize()});this.$scope.$watchGroup(["image.width","image.height"],function(){_this.computeSize()})};ImageController.prototype.computeSize=function(){this.computedHeight=null;this.computedWidth=null;if(angular.isUndefined(this.width)&&angular.isUndefined(this.height)){return}if(angular.isUndefined(this.height)){this.setWidth(this.width)}else if(angular.isUndefined(this.width)){this.setHeight(this.height)}else if(this.getComputedWidth()>this.width){this.setWidth(this.width)}else{this.setHeight(this.height)}};ImageController.prototype.getComputedHeight=function(){return this.width/Number(this.imageWidth)*Number(this.imageHeight)};ImageController.prototype.getComputedWidth=function(){return this.height/Number(this.imageHeight)*Number(this.imageWidth)};ImageController.prototype.setHeight=function(height){this.computedHeight=height;this.computedWidth=this.getComputedWidth();this.setLeftOffset()};ImageController.prototype.setLeftOffset=function(offset){if(angular.isUndefined(offset)){offset=angular.isDefined(this.width)?(this.width-this.getComputedWidth())/2:0}this.imageStyle.left=offset+"px"};ImageController.prototype.setWidth=function(width){this.computedHeight=this.getComputedHeight();this.computedWidth=width;this.setLeftOffset(0)};return ImageController}();core.ImageController=ImageController;angular.module("amo.flickr.core").controller("AmoImageController",ImageController)})(core=flickr.core||(flickr.core={}))})(flickr=amo.flickr||(amo.flickr={}))})(amo||(amo={}));angular.module("amo.flickr.core").run(["$templateCache",function($templateCache){$templateCache.put("flickr/album/flickr-album.html",'<div class="amo-flickr-album">\n    <div class="amo-flickr-album-thumbnails" amo-flickr-album-thumbnail-list>\n        <ul>\n            <li\n                amo-flickr-album-thumbnail="photo"\n                index="{{ $index }}"\n                is-photo-active="flickrAlbum.isPhotoActive(photo)"\n                on-click="flickrAlbum.setPhotoIndex(index)"\n                ng-repeat="photo in flickrAlbum.album.photo"\n                thumbnail-size="{{ flickrAlbum.thumbnailSize }}">\n            </li>\n        </ul>\n    </div>\n    <amo-flickr-photo\n        class="amo-flickr-album-photo"\n        height="flickrAlbum.photoHeight"\n        photo="flickrAlbum.getCurrentPhoto()"\n        size="o"\n        thumbnail-size="s"\n        width="flickrAlbum.photoWidth">\n    </amo-flickr-photo>\n    <a\n        class="navigation navigation-left"\n        ng-click="flickrAlbum.navigatePreviousPhoto()">\n    </a>\n    <a\n        class="navigation navigation-right"\n        ng-click="flickrAlbum.navigateNextPhoto()">\n    </a>\n</div>\n');$templateCache.put("flickr/album-list/flickr-album-list.html",'<div class="amo-flickr-album-list-container">\n    <ul class="amo-flickr-album-list">\n        <li ng-repeat="album in flickrAlbumList.albums">\n            <a\n                class="link-item"\n                ng-bind="album.title._content"\n                ng-class="{ \'active\': flickrAlbumList.isAlbumActive(album) }"\n                ng-click="flickrAlbumList.setAlbum(album)">\n            </a>\n        </li>\n    </ul>\n    <amo-flickr-album\n        album-id="{{ flickrAlbumList.currentAlbumId }}"\n        user-id="{{ flickrAlbumList.userId }}">\n    </amo-flickr-album>\n</div>\n');$templateCache.put("flickr/album/thumbnail/flickr-album-thumbnail.html",'<li>\n    <a\n        class="link-item"\n        ng-class="{ \'active\': albumThumbnail.isPhotoActive }"\n        ng-click="albumThumbnail.setPhotoIndex()">\n        <amo-flickr-photo\n            height="albumThumbnail.thumbnailSize"\n            photo="albumThumbnail.photo"\n            size="s">\n        </amo-flickr-photo>\n    </a>\n</li>\n');$templateCache.put("flickr/core/photo/flickr-photo.html",'<div class="amo-flickr-photo">\n    <amo-image\n        height="flickrPhoto.height"\n        image-alt="flickrPhoto.photo.title"\n        image-height="flickrPhoto.imageHeight"\n        image-source="flickrPhoto.imageSource"\n        image-width="flickrPhoto.imageWidth"\n        thumbnail-source="flickrPhoto.thumbnailSource"\n        width="flickrPhoto.width">\n    </amo-image>\n</div>\n');$templateCache.put("flickr/core/photo/image/image.html",'<div\n    class="amo-image-container"\n    ng-class="{ \'state-loaded\': image.isLoaded }"\n    ng-style="image.imageStyle">\n    <img\n        class="amo-image"\n        ng-attr-alt="{{ image.imageAlt }}"\n        ng-attr-height="{{ image.computedHeight }}"\n        ng-attr-width="{{ image.computedWidth }}"\n        ng-src="{{ image.source }}">\n</div>\n')}]);