var app;(function(app){"use strict";angular.module("flickrAlbumDemo",["flickrAlbumDemo.core"])})(app||(app={}));var app;(function(app){var core;(function(core){"use strict";angular.module("flickrAlbumDemo.core",["amo.flickrAlbum"])})(core=app.core||(app.core={}))})(app||(app={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var RunBlock=function(){function RunBlock(amoFlickrEventService){}RunBlock.$inject=["amoFlickrEventService"];return RunBlock}();flickrAlbum.RunBlock=RunBlock;angular.module("amo.flickrAlbum",[]).run(RunBlock)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var app;(function(app){var core;(function(core){"use strict";var AppConfig=function(){function AppConfig(amoFlickrConfigurationProvider){amoFlickrConfigurationProvider.setApiKey("7aca3f4de277f6252ffc05aab58ab601")}AppConfig.$inject=["amoFlickrConfigurationProvider"];return AppConfig}();core.AppConfig=AppConfig;angular.module("flickrAlbumDemo.core").config(AppConfig)})(core=app.core||(app.core={}))})(app||(app={}));var app;(function(app){var core;(function(core){"use strict";var AppController=function(){function AppController(){}AppController.prototype.onChange=function(label){console.log("onChange",label)};return AppController}();core.AppController=AppController;angular.module("flickrAlbumDemo.core").controller("AppController",AppController)})(core=app.core||(app.core={}))})(app||(app={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var _configuration={apiKey:null,thumbnailSize:100};var FlickrConfigurationProvider=function(){function FlickrConfigurationProvider(){}FlickrConfigurationProvider.prototype.$get=function(){return _configuration};FlickrConfigurationProvider.prototype.setApiKey=function(key){_configuration.apiKey=key;return this};FlickrConfigurationProvider.prototype.setThumbnailSize=function(thumbnailSize){_configuration.thumbnailSize=thumbnailSize;return this};FlickrConfigurationProvider.prototype.setUserId=function(userId){_configuration.userId=userId;return this};return FlickrConfigurationProvider}();flickrAlbum.FlickrConfigurationProvider=FlickrConfigurationProvider;angular.module("amo.flickrAlbum").provider("amoFlickrConfiguration",FlickrConfigurationProvider)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrAlbumController=function(){function FlickrAlbumController($element,$scope,amoFlickrApiService,amoFlickrConfiguration){var _this=this;this.$element=$element;this.$scope=$scope;this.amoFlickrConfiguration=amoFlickrConfiguration;this.setPhotoSize();this.thumbnailSize=amoFlickrConfiguration.thumbnailSize;$scope.$on("amo.flickr.windowResize",function(){_this.$scope.$apply(function(){_this.setPhotoSize()})});$scope.$on("amo.flickr.navigateNext",function(){_this.$scope.$apply(function(){return _this.navigateNextPhoto()})});$scope.$on("amo.flickr.navigatePrevious",function(){_this.$scope.$apply(function(){return _this.navigatePreviousPhoto()})});$scope.$watch("flickrAlbum.albumId",function(albumId){if(angular.isUndefined(albumId)){return}amoFlickrApiService.fetchAlbum(albumId,_this.userId).then(function(album){_this.currentPhotoIndex=album.photo.length>0?0:-1;_this.album=album})})}FlickrAlbumController.$inject=["$element","$scope","amoFlickrApiService","amoFlickrConfiguration"];FlickrAlbumController.prototype.getCurrentPhoto=function(){if(angular.isUndefined(this.album)){return null}return this.album.photo[this.currentPhotoIndex]};FlickrAlbumController.prototype.isPhotoActive=function(photo){if(this.currentPhotoIndex<0){return false}return this.getCurrentPhoto().id===photo.id};FlickrAlbumController.prototype.navigateNextPhoto=function(){if(angular.isDefined(this.album)&&this.currentPhotoIndex>=this.album.photo.length-1){return}this.currentPhotoIndex++};FlickrAlbumController.prototype.navigatePreviousPhoto=function(){if(this.currentPhotoIndex<=0){return}this.currentPhotoIndex--};FlickrAlbumController.prototype.setPhotoIndex=function(index){this.currentPhotoIndex=index};FlickrAlbumController.prototype.setPhotoSize=function(){this.photoHeight=this.$element[0].offsetHeight-this.amoFlickrConfiguration.thumbnailSize-2;this.photoWidth=this.$element[0].offsetWidth};return FlickrAlbumController}();flickrAlbum.FlickrAlbumController=FlickrAlbumController;angular.module("amo.flickrAlbum").controller("AmoFlickrAlbumController",FlickrAlbumController)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrAlbumDirective=function(){function FlickrAlbumDirective(){this.bindToController=true;this.controller="AmoFlickrAlbumController";this.controllerAs="flickrAlbum";this.restrict="E";this.replace=true;this.scope={albumId:"@",userId:"@"};this.templateUrl="flickr-album/album/flickr-album.html"}FlickrAlbumDirective.instance=function(){return new FlickrAlbumDirective};return FlickrAlbumDirective}();flickrAlbum.FlickrAlbumDirective=FlickrAlbumDirective;angular.module("amo.flickrAlbum").directive("amoFlickrAlbum",FlickrAlbumDirective.instance)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrEventService=function(){function FlickrEventService($document,$rootScope,$window){$window.addEventListener("resize",function(){$rootScope.$broadcast("amo.flickr.windowResize")});$document[0].body.addEventListener("keydown",function(e){switch(e.keyCode){case 37:case 38:$rootScope.$broadcast("amo.flickr.navigatePrevious");break;case 39:case 40:$rootScope.$broadcast("amo.flickr.navigateNext");break;default:break}})}FlickrEventService.$inject=["$document","$rootScope","$window"];return FlickrEventService}();flickrAlbum.FlickrEventService=FlickrEventService;angular.module("amo.flickrAlbum").service("amoFlickrEventService",FlickrEventService)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrAlbumListController=function(){function FlickrAlbumListController(amoFlickrApiService){var _this=this;amoFlickrApiService.fetchAlbumList(this.userId).then(function(albums){_this.albums=albums;if(albums.length>0){_this.currentAlbumId=albums[0].id}})}FlickrAlbumListController.$inject=["amoFlickrApiService"];FlickrAlbumListController.prototype.isAlbumActive=function(album){return this.currentAlbumId===album.id};FlickrAlbumListController.prototype.setAlbum=function(album){this.currentAlbumId=album.id};return FlickrAlbumListController}();flickrAlbum.FlickrAlbumListController=FlickrAlbumListController;angular.module("amo.flickrAlbum").controller("AmoFlickrAlbumListController",FlickrAlbumListController)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrAlbumListDirective=function(){function FlickrAlbumListDirective(){this.bindToController=true;this.controller="AmoFlickrAlbumListController";this.controllerAs="flickrAlbumList";this.replace=true;this.restrict="E";this.scope={userId:"@"};this.templateUrl="flickr-album/album-list/flickr-album-list.html"}FlickrAlbumListDirective.instance=function(){return new FlickrAlbumListDirective};return FlickrAlbumListDirective}();flickrAlbum.FlickrAlbumListDirective=FlickrAlbumListDirective;angular.module("amo.flickrAlbum").directive("amoFlickrAlbumList",FlickrAlbumListDirective.instance)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrApiConfigurationFactory=function(){function FlickrApiConfigurationFactory(){this.origin="https://api.flickr.com/services/rest/";return this}return FlickrApiConfigurationFactory}();flickrAlbum.FlickrApiConfigurationFactory=FlickrApiConfigurationFactory;angular.module("amo.flickrAlbum").factory("amoFlickrApiConfigurationFactory",FlickrApiConfigurationFactory)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrApiService=function(){function FlickrApiService($http,$q,amoFlickrApiConfigurationFactory,amoFlickrConfiguration){this.$http=$http;this.$q=$q;this.amoFlickrApiConfigurationFactory=amoFlickrApiConfigurationFactory;this.amoFlickrConfiguration=amoFlickrConfiguration}FlickrApiService.$inject=["$http","$q","amoFlickrApiConfigurationFactory","amoFlickrConfiguration"];FlickrApiService.prototype.get=function(method,config){var _this=this;if(angular.isUndefined(config)){config={}}if(angular.isUndefined(config.params)){config.params={}}angular.extend(config.params,{api_key:this.amoFlickrConfiguration.apiKey,format:"json",method:"flickr."+method,nojsoncallback:1});return this.$http.get(this.amoFlickrApiConfigurationFactory.origin,config).then(function(result){if(result.data.stat==="fail"){return _this.$q.reject(result.data)}return result.data})};FlickrApiService.prototype.fetchAlbum=function(albumId,userId){if(angular.isUndefined(userId)){userId=this.amoFlickrConfiguration.userId}return this.get("photosets.getPhotos",{params:{extras:"url_s,url_o",photoset_id:albumId,user_id:userId}}).then(function(data){return data.photoset})};FlickrApiService.prototype.fetchAlbumList=function(userId){if(angular.isUndefined(userId)){userId=this.amoFlickrConfiguration.userId}return this.get("photosets.getList",{params:{per_page:100,user_id:userId}}).then(function(data){return data.photosets.photoset})};return FlickrApiService}();flickrAlbum.FlickrApiService=FlickrApiService;angular.module("amo.flickrAlbum").service("amoFlickrApiService",FlickrApiService)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrPhotoController=function(){function FlickrPhotoController($scope){var _this=this;$scope.$watchGroup(["flickrPhoto.photo","flickrPhoto.width","flickrPhoto.height"],function(values){if(angular.isUndefined(values[0])||values[0]===null){return}_this.imageHeight=_this.getPhotoValue("height");_this.imageSource=_this.getPhotoValue("url");_this.imageWidth=_this.getPhotoValue("width");if(angular.isDefined(_this.thumbnailSize)){_this.thumbnailSource=_this.getPhotoValue("url",_this.thumbnailSize)}})}FlickrPhotoController.$inject=["$scope"];FlickrPhotoController.prototype.getPhotoValue=function(property,size){if(angular.isUndefined(this.photo)){return null}if(angular.isUndefined(size)){size=this.size}return this.photo[property+"_"+size]};return FlickrPhotoController}();flickrAlbum.FlickrPhotoController=FlickrPhotoController;angular.module("amo.flickrAlbum").controller("AmoFlickrPhotoController",FlickrPhotoController)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var FlickrPhotoDirective=function(){function FlickrPhotoDirective(){this.bindToController=true;this.controller="AmoFlickrPhotoController";this.controllerAs="flickrPhoto";this.restrict="E";this.replace=true;this.scope={height:"=",photo:"=",size:"@",thumbnailSize:"@",width:"="};this.templateUrl="flickr-album/photo/flickr-photo.html"}FlickrPhotoDirective.instance=function(){return new FlickrPhotoDirective};return FlickrPhotoDirective}();flickrAlbum.FlickrPhotoDirective=FlickrPhotoDirective;angular.module("amo.flickrAlbum").directive("amoFlickrPhoto",FlickrPhotoDirective.instance)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var ImageController=function(){function ImageController($scope){var _this=this;this.imageStyle={};var asynchronousImage,width;$scope.$watchGroup(["image.imageSource","image.width","image.height"],function(values){if(angular.isUndefined(values[0])){return}if(angular.isDefined(_this.thumbnailSource)){_this.source=_this.thumbnailSource;asynchronousImage=new Image;asynchronousImage.onload=function(){$scope.$apply(function(){_this.source=asynchronousImage.src})};asynchronousImage.src=_this.imageSource}else{_this.source=_this.imageSource}_this.computedHeight=null;_this.computedWidth=null;if(angular.isUndefined(values[1])&&angular.isUndefined(values[2])){return}if(angular.isUndefined(_this.height)){_this.setWidth(_this.width)}else if(angular.isUndefined(_this.width)){_this.setHeight(_this.height)}if(_this.getComputedWidth()>_this.width){_this.setWidth(_this.width)}else{_this.setHeight(_this.height)}})}ImageController.$inject=["$scope"];ImageController.prototype.getComputedHeight=function(){return this.width/Number(this.imageWidth)*Number(this.imageHeight)};ImageController.prototype.getComputedWidth=function(){return this.height/Number(this.imageHeight)*Number(this.imageWidth)};ImageController.prototype.setHeight=function(height){this.computedHeight=height;this.computedWidth=this.getComputedWidth();this.setLeftOffset()};ImageController.prototype.setLeftOffset=function(offset){if(angular.isUndefined(offset)){offset=(this.width-this.getComputedWidth())/2}this.imageStyle.left=offset+"px"};ImageController.prototype.setWidth=function(width){this.computedHeight=this.getComputedHeight();this.computedWidth=width;this.setLeftOffset(0)};return ImageController}();flickrAlbum.ImageController=ImageController;angular.module("amo.flickrAlbum").controller("AmoImageController",ImageController)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));var amo;(function(amo){var flickrAlbum;(function(flickrAlbum){"use strict";var ImageDirective=function(){function ImageDirective(){this.bindToController=true;this.controller="AmoImageController";this.controllerAs="image";this.restrict="E";this.replace=true;this.scope={height:"=",imageAlt:"=",imageHeight:"=",imageSource:"=",imageWidth:"=",thumbnailSource:"=",width:"="};this.templateUrl="flickr-album/photo/image/image.html"}ImageDirective.instance=function(){return new ImageDirective};return ImageDirective}();flickrAlbum.ImageDirective=ImageDirective;angular.module("amo.flickrAlbum").directive("amoImage",ImageDirective.instance)})(flickrAlbum=amo.flickrAlbum||(amo.flickrAlbum={}))})(amo||(amo={}));angular.module("amo.flickrAlbum").run(["$templateCache",function($templateCache){$templateCache.put("flickr-album/album/flickr-album.html",'<div class="amo-flickr-album">\n    <div class="amo-flickr-album-thumbnails">\n        <ul>\n            <li ng-repeat="photo in flickrAlbum.album.photo">\n                <a\n                    class="link-item"\n                    ng-class="{ \'active\': flickrAlbum.isPhotoActive(photo) }"\n                    ng-click="flickrAlbum.setPhotoIndex($index)">\n                    <amo-flickr-photo\n                        height="flickrAlbum.thumbnailSize"\n                        photo="photo"\n                        size="s">\n                    </amo-flickr-photo>\n                </a>\n            </li>\n        </ul>\n    </div>\n    <amo-flickr-photo\n        class="amo-flickr-album-photo"\n        height="flickrAlbum.photoHeight"\n        photo="flickrAlbum.getCurrentPhoto()"\n        size="o"\n        thumbnail-size="s"\n        width="flickrAlbum.photoWidth">\n    </amo-flickr-photo>\n    <a\n        class="navigation navigation-left"\n        ng-click="flickrAlbum.navigatePreviousPhoto()">\n    </a>\n    <a\n        class="navigation navigation-right"\n        ng-click="flickrAlbum.navigateNextPhoto()">\n    </a>\n</div>\n');$templateCache.put("flickr-album/album-list/flickr-album-list.html",'<div class="amo-flickr-album-list-container">\n    <ul class="amo-flickr-album-list">\n        <li ng-repeat="album in flickrAlbumList.albums">\n            <a\n                class="link-item"\n                ng-bind="album.title._content"\n                ng-class="{ \'active\': flickrAlbumList.isAlbumActive(album) }"\n                ng-click="flickrAlbumList.setAlbum(album)">\n            </a>\n        </li>\n    </ul>\n    <amo-flickr-album\n        album-id="{{ flickrAlbumList.currentAlbumId }}"\n        user-id="{{ flickrAlbumList.userId }}">\n    </amo-flickr-album>\n</div>\n');$templateCache.put("flickr-album/photo/flickr-photo.html",'<div class="amo-flickr-photo">\n    <amo-image\n        height="flickrPhoto.height"\n        image-alt="flickrPhoto.photo.title"\n        image-height="flickrPhoto.imageHeight"\n        image-source="flickrPhoto.imageSource"\n        image-width="flickrPhoto.imageWidth"\n        thumbnail-source="flickrPhoto.thumbnailSource"\n        width="flickrPhoto.width">\n    </amo-image>\n</div>\n');$templateCache.put("flickr-album/photo/image/image.html",'<div class="amo-image-container">\n    <img\n        class="amo-image"\n        ng-attr-alt="{{ image.imageAlt }}"\n        ng-attr-height="{{ image.computedHeight }}"\n        ng-attr-width="{{ image.computedWidth }}"\n        ng-src="{{ image.source }}"\n        ng-style="image.imageStyle">\n</div>\n')}]);